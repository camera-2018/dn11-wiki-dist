import{_ as a,c as n,o as i,a2 as e}from"./chunks/framework.9Uv4PgnO.js";const c=JSON.parse('{"title":"rDNS","description":"","frontmatter":{},"headers":[],"relativePath":"mics/rdns.md","filePath":"mics/rdns.md"}'),p={name:"mics/rdns.md"};function l(r,s,h,t,d,k){return i(),n("div",null,[...s[0]||(s[0]=[e(`<h1 id="rdns" tabindex="-1">rDNS <a class="header-anchor" href="#rdns" aria-label="Permalink to &quot;rDNS&quot;">​</a></h1><p>请先阅读 DNS 一章再阅读本章。</p><p>本文只介绍 IPv4 相关情况。</p><h2 id="名词解释" tabindex="-1">名词解释 <a class="header-anchor" href="#名词解释" aria-label="Permalink to &quot;名词解释&quot;">​</a></h2><h3 id="ptr-记录" tabindex="-1">PTR 记录 <a class="header-anchor" href="#ptr-记录" aria-label="Permalink to &quot;PTR 记录&quot;">​</a></h3><blockquote><p>a domain name pointer</p><p>-- RFC1035 3.2.2. TYPE values</p></blockquote><p>一个指向域名的指针</p><div class="language-plain vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>;; ANSWER SECTION:</span></span>
<span class="line"><span>woshiluo.dn11.          600     IN      PTR     hello.world.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="rdns-reverse-dns" tabindex="-1">rDNS (Reverse DNS) <a class="header-anchor" href="#rdns-reverse-dns" aria-label="Permalink to &quot;rDNS (Reverse DNS)&quot;">​</a></h3><blockquote><p>A reverse DNS lookup is a DNS query for the domain name associated with a given IP address. This accomplishes the opposite of the more commonly used forward DNS lookup, in which the DNS system is queried to return an IP address.</p><p>-- <a href="https://www.cloudflare.com/learning/dns/glossary/reverse-dns/" target="_blank" rel="noreferrer">What is reverse DNS?</a></p></blockquote><p>从给定 IP 地址反查出对应的域名。某种程度上，是 A 记录的逆运算。</p><h2 id="rdns-是怎么工作的" tabindex="-1">rDNS 是怎么工作的？ <a class="header-anchor" href="#rdns-是怎么工作的" aria-label="Permalink to &quot;rDNS 是怎么工作的？&quot;">​</a></h2><blockquote><p>The Internet uses a special domain to support gateway location and Internet address to host mapping.</p><p>The domain begins at IN-ADDR.ARPA and has a substructure which follows the Internet addressing structure.</p><p>-- RFC1035 3.5. IN-ADDR.ARPA domain</p></blockquote><p>在同章节描述了所谓的 &quot;substructure&quot;，即具体的工作原理。下文以中文转述。</p><p>rDNS 使用 <code>in-addr.arpa.</code> 域来进行解析。</p><p>我们知道，IPv4 可以使用十进制点分法表示成 <code>a.b.c.d</code> ，其中 a b c d 表示一个 8 位整数（即 0-255）。</p><p>那么 <code>a.in-addr.arpa</code> 即表示 <code>a.0.0.0/8</code> 的相关信息， <code>b.a.in-addr.arpa</code> 即表示 <code>a.b.0.0/16</code> 的相关信息，以此类推。</p><p>对于 rDNS 记录，使用 PTR 记录来表示。</p><div class="language-plain vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>10.IN-ADDR.ARPA.           PTR MILNET-GW.ISI.EDU.</span></span>
<span class="line"><span>10.IN-ADDR.ARPA.           PTR GW.LCS.MIT.EDU.</span></span>
<span class="line"><span>18.IN-ADDR.ARPA.           PTR GW.LCS.MIT.EDU.</span></span>
<span class="line"><span>26.IN-ADDR.ARPA.           PTR MILNET-GW.ISI.EDU.</span></span>
<span class="line"><span>22.0.2.10.IN-ADDR.ARPA.    PTR MILNET-GW.ISI.EDU.</span></span>
<span class="line"><span>103.0.0.26.IN-ADDR.ARPA.   PTR MILNET-GW.ISI.EDU.</span></span>
<span class="line"><span>77.0.0.10.IN-ADDR.ARPA.    PTR GW.LCS.MIT.EDU.</span></span>
<span class="line"><span>4.0.10.18.IN-ADDR.ARPA.    PTR GW.LCS.MIT.EDU.</span></span>
<span class="line"><span>103.0.3.26.IN-ADDR.ARPA.   PTR A.ISI.EDU.</span></span>
<span class="line"><span>6.0.0.10.IN-ADDR.ARPA.     PTR MULTICS.MIT.EDU.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>Make sure your PTR and A records match. For every IP address, there should be a matching PTR record in the in-addr.arpa domain.</p><p>-- RFC1912 2.1 Inconsistent, Missing, or Bad Data</p></blockquote><p>你应该确保 PTR 记录和 A 记录互相匹配。</p><h2 id="如何查询-rdns" tabindex="-1">如何查询 rDNS <a class="header-anchor" href="#如何查询-rdns" aria-label="Permalink to &quot;如何查询 rDNS&quot;">​</a></h2><p>显然你可以直接查询对应的 PTR 记录。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.20.16.172.in-addr.arpa</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&gt;&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DiG</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9.20.13</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&gt;&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.20.16.172.in-addr.arpa</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; global options: +cmd</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; Got answer:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 63999</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; OPT PSEUDOSECTION:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">; EDNS: version: 0, flags:; udp: 1232</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; QUESTION SECTION:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;1.20.16.172.in-addr.arpa.      IN      PTR</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; ANSWER SECTION:</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1.20.16.172.in-addr.arpa. 587   IN      PTR     nas.node.woshiluo.dn11.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; Query time: 0 msec</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; SERVER: 127.0.0.1#53(127.0.0.1) (UDP)</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; WHEN: Sun Sep 28 10:59:15 CST 2025</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">;; MSG SIZE  rcvd: 89</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>也可以使用 host 命令。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 172.16.20.53</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">53.20.16.172.in-addr.arpa</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> domain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pointer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> woshiluo.dn11.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用 ping/traceroute/mtr 都会通过该方法来查询主机名，不过有可能会被其他东西覆盖结果（比如 hosts）。</p><h2 id="如何在-dn11-中使用-rdns" tabindex="-1">如何在 DN11 中使用 rDNS <a class="header-anchor" href="#如何在-dn11-中使用-rdns" aria-label="Permalink to &quot;如何在 DN11 中使用 rDNS&quot;">​</a></h2><p>根据原理，我们要做的操作其实只有两个：</p><ol><li>将对应域委托给自己进行解析；</li><li>添加对应的 PTR 记录。</li></ol><p>下文假设你的 IP 为 <code>172.16.20.0/24</code> ，权威 dns 为 <code>ns1.woshiluo.com</code> ，请自行修改。</p><h3 id="注册" tabindex="-1">注册 <a class="header-anchor" href="#注册" aria-label="Permalink to &quot;注册&quot;">​</a></h3><p>首先，你应该在 <a href="https://github.com/dn-11/registry" target="_blank" rel="noreferrer">registry</a> 中注册自己 IP range 的 NS。</p><p>比如你申请了 <code>172.16.20.0/24</code> 段，那么你应该将 <code>20.16.172.in-addr.arpa</code> 委托到自己的权威服务器上：</p><div class="language-diff vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">diff --git a/as/4211111460.yml b/as/4211111460.yml</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index 58395ef..52f5a2e 100644</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;">--- a/as/4211111460.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+++ b/as/4211111460.yml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-light-font-weight:bold;--shiki-dark:#B392F0;--shiki-dark-font-weight:bold;">@@ -5,5 +5,7 @@</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ip:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> domain:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   woshiluo.dn11:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     - ns1.woshiluo.dn11</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+  20.16.172.in-addr.arpa:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">+    - ns1.woshiluo.dn11</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ns:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   ns1.woshiluo.dn11:  172.16.20.53</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="添加解析" tabindex="-1">添加解析 <a class="header-anchor" href="#添加解析" aria-label="Permalink to &quot;添加解析&quot;">​</a></h3><p>参照 DNS 一文，你需要添加对该 zone （20.16.172.in-addr.arpa）的解析，并通过 zonefile 添加 PTR 记录。</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ORIGIN 20.16.172.in-addr.arpa.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$TTL  60</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  SOA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns1.woshiluo.dn11.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hostmaster.woshiluo.dn11.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2025092717</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 604800</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 60</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  NS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ns1.woshiluo.dn11.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">announce</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zone</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> be</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns1.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   nas.node.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   laptop.node.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">       IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   dorm210.node.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">10</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   jp.node.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   hk.node.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">12</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   us.node.woshiluo.dn11.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      IN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  PTR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   woshiluo.dn11.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="同步他人-zoneinfo" tabindex="-1">同步他人 zoneinfo <a class="header-anchor" href="#同步他人-zoneinfo" aria-label="Permalink to &quot;同步他人 zoneinfo&quot;">​</a></h3><p>在 registry 注册的 rDNS 委托信息会被自动汇总到 metadata 仓库下的 <code>dn11-rdns.zone</code> 文件，你可以查询该仓库的 README 文件以获取其在腾讯云上的镜像链接。</p><p>你可以参考 dns 一章中拉取同步一节的脚本来进行自动同步。</p>`,41)])])}const F=a(p,[["render",l]]);export{c as __pageData,F as default};
